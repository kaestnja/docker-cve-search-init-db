Prepare a dump of the DB to speed up the launch of cve-search container.

The dump file is `data.init.tgz`.
To rebuild such a dump, just go to a running local instance, kill mongo and redis, dump the db:

In your running cve-search local container (don't do it on a prod container to avoid stop services)

```
# Adapt the container name from cve to FOO if you called your cve-search container FOO

# Kill mongo
sudo docker exec cve bash -c 'kill $(pidof -x "mongod")'

# Kill redis
sudo docker exec cve bash -c 'kill $(pidof -x "redis-server")'

# Dump the current Mongo and Redis DB
sudo docker exec cve bash -c 'tar -C / -czvf /tmp/cve-search.db.init.tgz /data /var/lib/redis'
```

On your host:

The idea is to keep the master branch "light", without any binary files.
We store the binary files for each version in a dedicated branch, to be called from the cve-search Dockerfile.withdb through its tgz form (see https://github.com/lounagen/docker-cve-search/blob/master/Dockerfile.withdb).

```
# Create a new release branch with version and date (adapt for your cve-search version)
CVE_SEARCH_VERSION=4.2

# Adapt suffix if you need the full CVE DB or since 2022 only
# BRANCH_SUFFIX=""
# BRANCH_SUFFIX="-since2022"
BRANCH_SUFFIX="-since2022"
BRANCH=${CVE_SEARCH_VERSION}-$(date '+%Y%m%d')${BRANCH_SUFFIX}

git checkout master
git checkout -b ${BRANCH}

# Copy the dump from the container to your host
# Adapt the container name from cve to FOO if you called your cve-search container FOO 
sudo docker cp cve:/tmp/cve-search.db.init.tgz ./

# To avoid the 100M max file size limitation on github, split this big file into 10M pieces
mkdir -p ./files
rm -fr ./files/initdb_split_*
split -b 10m ./cve-search.db.init.tgz ./files/initdb_split_

# Clean initdb big file
sudo rm cve-search.db.init.tgz

# Note: To restore the original file, use cat
# cat ./files/initdb_split_* > cve-search.db.init.tgz

# Commit files folder and push the new branch
git add files
git commit -m "Add init db for this new cve-search version"

# Add a tag only to fill the by-tag artifacts pages on GitHub
git tag v${BRANCH}

# Push back the new branch to GitHub
git push --tags --set-upstream origin ${BRANCH}
```
